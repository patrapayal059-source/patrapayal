{% extends "base.html" %}
{% block content %}

<div class="container">
    <h2>ðŸ“Š Daily Issue Report</h2>

    <!-- Search Form -->
    <form method="get" style="margin-bottom: 20px; display: flex; gap: 10px;">
        
        <!-- Date Search -->
        <input type="date" name="date" value="{{ search_date }}">

        <!-- Username Search -->
        <select name="username">
            <option value="">Select User</option>
            {% for u in users %}
                <option value="{{ u['username'] }}"
                    {% if search_user == u['username'] %}selected{% endif %}>
                    {{ u['username'] }}
                </option>
            {% endfor %}
        </select>

        <button type="submit">Search</button>
    </form>

    {% if search_date or search_user %}
        <p><strong>Date:</strong> {{ search_date }}</p>
        <p><strong>Total Books Issued:</strong> {{ total_issued }}</p>
    {% endif %}

    <!-- Report Table -->
    {% if issued_books %}
        <table border="1" cellpadding="8" cellspacing="0">
            <tr>
                <th>User Name</th>
                <th>Book Name</th>
                <th>Issue Date</th>
                <th>Return Date</th>
            </tr>
            {% for row in issued_books %}
            <tr>
                <td>{{ row['username'] }}</td>
                <td>{{ row['book_name'] }}</td>
                <td>{{ row['issue_date'] }}</td>
                <td>{{ row['return_date'] }}</td>
            </tr>
            {% endfor %}
        </table>
    {% elif search_date or search_user %}
        <p>No records found.</p>
    {% endif %}
</div>

{% endblock %}
